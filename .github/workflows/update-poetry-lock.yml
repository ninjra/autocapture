name: Update poetry.lock 
on: workflow_dispatch:

permissions: contents: write

jobs: regen-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 with: persist-credentials: true - name: Set up Python uses: actions/setup-python@v4 with: python-version: '3.12' - name: Install Poetry run: | python -m pip install --upgrade pip pip install poetry - name: Regenerate poetry.lock run: | poetry lock --no-update - name: Commit and push lockfile env: GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} run: | git config user.name "github-actions[bot]" git config user.email "41898282+github-actions[bot]@users.noreply.github.com" git add poetry.lock git commit -m "ci: regenerate poetry.lock" || echo "no changes to commit" git push origin HEAD:refs/heads/chore/update-poetry-lock || echo "push failed"
