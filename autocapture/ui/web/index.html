<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Autocapture Memory Engine</title>
    <link rel="manifest" href="/static/manifest.json" />
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <div class="app-shell">
      <header class="topbar">
        <div class="brand">
          <div class="brand-mark"></div>
          <div>
            <h1>Autocapture</h1>
            <p class="brand-subtitle">Personal Memory Engine</p>
          </div>
        </div>
        <div id="statusBar" class="status-bar"></div>
        <nav class="nav-tabs">
          <button data-tab="chat" class="active">Ask</button>
          <button data-tab="search">Search</button>
          <button data-tab="highlights">Highlights</button>
          <button data-tab="settings">Settings</button>
          <button data-tab="maintenance">Maintenance</button>
          <button data-tab="audit">Audit</button>
          <button data-tab="plugins">Plugins</button>
        </nav>
      </header>
      <main>
        <section id="chat" class="tab active">
          <div class="panel">
            <div class="controls">
              <label>Model
                <select id="modelSelect"></select>
              </label>
              <label><input type="checkbox" id="sanitizeToggle" checked /> Sanitize</label>
              <label><input type="checkbox" id="extractiveToggle" checked /> Extractive-only</label>
              <label>Time range
                <select id="timeRange">
                  <option value="24h">Last 24h</option>
                  <option value="7d">Last 7 days</option>
                  <option value="30d">Last 30 days</option>
                </select>
              </label>
              <div class="prompt-status">
                <span>Safe mode</span>
                <span id="safeModeIndicator" class="pill">--</span>
              </div>
            </div>
            <div id="answerBanner" class="banner"></div>
            <div id="thread" class="thread"></div>
            <form id="chatForm">
              <input id="chatInput" placeholder="Ask about your day..." />
              <button type="submit">Send</button>
            </form>
          </div>
        </section>
        <section id="search" class="tab">
          <div class="panel">
            <form id="searchForm">
              <input id="searchInput" placeholder="Search events" />
              <button type="submit">Search</button>
            </form>
            <div id="searchResults" class="results"></div>
          </div>
        </section>
        <section id="settings" class="tab">
          <div class="panel">
            <div class="panel-header">
              <div>
                <h2>Settings</h2>
                <p class="hint">Schema-driven settings with preview/apply safety gates.</p>
              </div>
              <div class="tier-selector" id="tierSelector"></div>
            </div>
            <div id="settingsForm" class="settings-grid"></div>
            <div class="settings-actions">
              <button id="previewSettings" type="button">Preview changes</button>
              <button id="applySettings" type="button" class="secondary">Apply changes</button>
              <span id="settingsStatus" class="settings-status">No pending changes</span>
            </div>
            <div id="settingsPreview" class="preview-panel"></div>
          </div>
        </section>
        <section id="maintenance" class="tab">
          <div class="panel">
            <div class="panel-header">
              <div>
                <h2>Performance</h2>
                <p class="hint">Runtime latency, queues, and profile controls.</p>
              </div>
              <div class="perf-controls">
                <label>Profile
                  <select id="perfProfileSelect">
                    <option value="auto">Auto (balanced)</option>
                    <option value="foreground">Max capture</option>
                    <option value="idle">Low impact</option>
                  </select>
                </label>
                <button id="applyPerfProfile" type="button" class="secondary">Apply</button>
              </div>
            </div>
            <div id="perfPanel" class="perf-grid"></div>
            <div class="perf-log">
              <div class="perf-log-header">
                <div>
                  <h3>Perf log</h3>
                  <p class="hint">Recent runtime snapshots from local JSONL logs.</p>
                </div>
                <div class="perf-log-controls">
                  <label>Component
                    <select id="perfLogComponent">
                      <option value="runtime">Runtime</option>
                      <option value="api">API</option>
                    </select>
                  </label>
                  <button id="refreshPerfLog" type="button" class="secondary">Refresh</button>
                </div>
              </div>
              <div id="perfLogStatus" class="hint"></div>
              <div id="perfLogEntries" class="perf-log-entries"></div>
            </div>
            <div class="split-grid">
              <div>
                <div class="panel-header">
                  <div>
                    <h2>Doctor</h2>
                    <p class="hint">Run diagnostics across storage, OCR, embeddings, and services.</p>
                  </div>
                  <button id="runDoctor" type="button">Run doctor</button>
                </div>
                <div id="doctorResults" class="diagnostics"></div>
              </div>
              <div>
                <div class="panel-header">
                  <div>
                    <h2>Delete data</h2>
                    <p class="hint">Preview and apply destructive deletes with preview tokens.</p>
                  </div>
                </div>
                <div class="delete-form">
                  <label>Kind
                    <select id="deleteKind">
                      <option value="range">Range</option>
                      <option value="all">All</option>
                    </select>
                  </label>
                  <label>Start UTC
                    <input id="deleteStart" placeholder="2026-01-20T00:00:00Z" />
                  </label>
                  <label>End UTC
                    <input id="deleteEnd" placeholder="2026-01-21T00:00:00Z" />
                  </label>
                  <label>Process (optional)
                    <input id="deleteProcess" placeholder="chrome.exe" />
                  </label>
                  <label>Window title (optional)
                    <input id="deleteWindowTitle" placeholder="Project X" />
                  </label>
                  <label>Confirm phrase
                    <input id="deleteConfirmPhrase" placeholder="DELETE" />
                  </label>
                  <label class="confirm-check"><input type="checkbox" id="deleteConfirmCheck" /> I understand this will delete data</label>
                  <div class="delete-actions">
                    <button id="previewDelete" type="button">Preview delete</button>
                    <button id="applyDelete" type="button" class="danger">Apply delete</button>
                  </div>
                  <div id="deletePreview" class="preview-panel"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="audit" class="tab">
          <div class="panel">
            <div class="panel-header">
              <div>
                <h2>Audit</h2>
                <p class="hint">Recent request runs, evidence counts, and answer citations.</p>
              </div>
              <button id="refreshAudit" type="button">Refresh</button>
            </div>
            <div class="split-grid">
              <div>
                <div id="auditList" class="audit-list"></div>
              </div>
              <div>
                <div id="auditDetail" class="audit-detail">Select a request to inspect.</div>
              </div>
            </div>
          </div>
        </section>
        <section id="plugins" class="tab">
          <div class="panel">
            <h2>Plugins</h2>
            <p class="hint">Plugins are discovered but must be explicitly enabled.</p>
            <div class="plugin-banner">
              <span class="label">Safe mode</span>
              <span id="pluginSafeMode" class="pill">--</span>
            </div>
            <div id="pluginWarnings" class="plugin-warnings"></div>
            <div id="pluginList" class="plugin-list"></div>
          </div>
        </section>
        <section id="highlights" class="tab">
          <div class="panel">
            <div class="panel-header">
              <div>
                <h2>Nightly Highlights</h2>
                <p class="hint">Daily summaries generated from your activity history.</p>
              </div>
              <div class="highlights-controls">
                <label>Day
                  <select id="highlightsDay"></select>
                </label>
                <button id="refreshHighlights">Refresh</button>
              </div>
            </div>
            <div id="highlightsContent" class="highlights-content"></div>
          </div>
        </section>
      </main>
    </div>
    <script src="/static/app.js"></script>
  </body>
</html>
